/*
 * Horparallax
 *
 * @version 1.0
 *
 * Copyright 2013, UpSolution
 */
!function(t){var i=function(i,e){var n=this;this.$window=t(window),this.container=t(i),void 0!=i.onclick&&(e=t.extend({},i.onclick()||{},"object"==typeof e&&e),this.container.removeProp("onclick")),e=t.extend({},t.fn.horparallax.defaults,"object"==typeof e&&e),this.options=e,this.bg=this.container.find(e.bgSelector),this.containerWidth=this.container.outerWidth(),this.containerHeight=this.container.outerHeight(),this.bgWidth=this.bg.outerWidth(),this.windowHeight=this.$window.height(),this._frameRate=Math.round(1e3/this.options.fps),this.mouseInside=!1,"ontouchstart"in window&&"DeviceOrientationEvent"in window||this.container.mouseenter(function(t){n.mouseInside=!0;var i=n.container.offset(),e=(t.pageX-i.left)/n.containerWidth;n.cancel(),n._hoverAnimation=!0,n._hoverFrom=n.now,n._hoverTo=e,n.start(n._hoverTo)}).mousemove(function(t){if(n.mouseInside&&!(n._lastFrame+n._frameRate>Date.now())){var i=n.container.offset(),e=(t.pageX-i.left)/n.containerWidth;if(n._hoverAnimation)return void(n._hoverTo=e);n.set(e),n._lastFrame=Date.now()}}).mouseleave(function(){n.mouseInside=!1,n.cancel(),n.start(n.options.basePoint)}),this.$window.resize(function(){n.handleResize()}),this._orientationDriven="ontouchstart"in window&&"DeviceOrientationEvent"in window,this._orientationDriven&&(this._checkIfVisible(),window.addEventListener("deviceorientation",function(t){!n.visible||n._lastFrame+n._frameRate>Date.now()||(n._deviceOrientationChange(t),n._lastFrame=Date.now())}),this.$window.resize(function(){n._checkIfVisible()}),this.$window.scroll(function(){n._checkIfVisible()})),this.set(this.options.basePoint),this._lastFrame=Date.now()};i.prototype={_deviceOrientationChange:function(t){var i,e=t.gamma,n=t.beta;switch(window.orientation){case-90:n=Math.max(-45,Math.min(45,n)),i=(n+45)/90;break;case 90:n=Math.max(-45,Math.min(45,n)),i=(45-n)/90;break;case 180:e=Math.max(-45,Math.min(45,e)),i=(e+45)/90;break;case 0:default:(-90>e||e>90)&&(e=Math.abs(t.gamma)/t.gamma*(180-Math.abs(t.gamma))),e=Math.max(-45,Math.min(45,e)),i=(45-e)/90}this.set(i)},handleResize:function(){this.containerWidth=this.container.outerWidth(),this.containerHeight=this.container.outerHeight(),this.bgWidth=this.bg.outerWidth(),this.windowHeight=this.$window.height(),this.set(this.now)},_checkIfVisible:function(){var t=this.$window.scrollTop(),i=this.container.offset().top;this.visible=i+this.containerHeight>t&&i<t+this.windowHeight},set:function(t){return this.bg.css("left",(this.containerWidth-this.bgWidth)*t),this.now=t,this},compute:function(t,i,e){return this._hoverAnimation?(this._hoverTo-this._hoverFrom)*e+this._hoverFrom:(i-t)*e+t},start:function(t){var i=this.now,e=this;return this.container.css("delta",0).animate({delta:1},{duration:this.options.duration,easing:this.options.easing,complete:function(){e._hoverAnimation=!1},step:function(n){e.set(e.compute(i,t,n))},queue:!1}),this},cancel:function(){return this._hoverAnimation=!1,this.container.stop(!0,!1),this}},void 0==t.easing.easeOutElastic&&(t.easing.easeOutElastic=function(t,i,e,n,o){var a=1.70158,s=0,h=n;if(0==i)return e;if(1==(i/=o))return e+n;if(s||(s=.3*o),h<Math.abs(n)){h=n;var a=s/4}else var a=s/(2*Math.PI)*Math.asin(n/h);return h*Math.pow(2,-10*i)*Math.sin(2*(i*o-a)*Math.PI/s)+n+e}),t.fn.horparallax=function(e){return this.each(function(){var n=t(this),o=n.data("horparallax");o||n.data("horparallax",o=new i(this,e))})},t.fn.horparallax.defaults={fps:60,basePoint:.5,duration:500,bgSelector:".l-submain-bg",easing:"swing"},t.fn.horparallax.Constructor=i}(jQuery);